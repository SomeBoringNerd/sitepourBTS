<!DOCTYPE html>
<!--

        PROBLÈMES CONNUS :
            -> les redirections utilisant une ancre ont un comportement aléatoire

            -> l'image de la page 404 a des issues a charger une image aléatoire

-->
<html>
    <head>
        <title>JustAFeeling, RPG Game</title>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        
        <link rel="stylesheet" href="index.css">
        
        <style type="text/css">
            select {
                clear:both;
            }
        </style>
    </head>
    <body>
        <script>
            // ce script est utilisé pour faire marcher l'entièreté du site correctement
            // l'anti internet explorer est juste histoire de le rendre fool-proof.
                                    
            // check pour le userargent 
            detectIEregexp = (navigator.userAgent.indexOf('MSIE') != -1) ? /MSIE (\d+\.\d+);/ : /Trident.*rv[ :]*(\d+\.\d+)/ ;
            
            // print le resultat
            console.log(detectIEregexp.test(navigator.userAgent) ? "l'utisateur utilise internet explorer" : "l'utilisateur n'utilise pas internet explorer");

            // si on est sur internet explorer
            if (detectIEregexp.test(navigator.userAgent)){ 
                alert(navigator.appName + " n'est pas supporté. Le site ne marchera donc pas. merci d'utiliser un navigateur comme Firefox");
                close();
            }

            // code volé sans honte ici :
            // https://beamtic.com/change-iframe-src-javascript
            // après j'ai changé pas mal de truc donc ça passe
            // c'est pas 100% du vol

            function changerDePage(name){        
                document.getElementById("iframe_modifiable").src = name;
            }

            // fonction pour générer de l'aléatoire
            function RandomInt(max){
                return 
            }
            
            // inspiré de ce que j'ai lu ici :
            // https://stackoverflow.com/a/17502197
            // le code ici est plutôt différent dû
            // a l'adaptation au contexte spécifique
            // dans lequel celui-ci s'execute.

            // s'execute lors du chargement de la page
            window.onload = function()
            {
                var url = document.location.href;

                // pour debug je print l'url actuelle du site
                // exemple : http://localhost/index.html?pages/fake_index.html
                console.log(url.toString());

                // super simple : le check vérifie qu'une requete
                // POST existe dans l'url.
                // la verification pour la fin de l'url
                // sert a rendre le concept fool-proof
                // car sinon ça charge le fichier "" qui ne peut exister
                if(url.includes('index.html?') && !url.endsWith('index.html?')){

                    // on récupère tout ce qu'il y'a après un "?" dans l'url.
                    // ça pourrait causer des problèmes si plusieurs sont présents, mais
                    // normalement ça devrait aller.
                    POST = url.split('?')[1].split('&');

                    // une fois fait on redirige vers la bonne page en utilisant 
                    // la méthode disponible plus haut car le iframe ne marche
                    // pas pareil.
                    changerDePage(POST[0]);

                    if(url.includes('404.html')){
                        let IMG_URL = 'http://localhost/rescources/memes/' + Math.floor(Math.random() * 10).toString() + '.png'
                        document.getElementById('iframe_modifiable').contentWindow.document.getElementById('image_contener').src = IMG_URL;

                        setTimeout(function(){
                            //location.href='https://youtu.be/dQw4w9WgXcQ?autoplay=1';
                        }, 10000);
                    }
                }else{
                    location.href='index.html?pages/fake_index.html';
                }
            }


        </script>
        <center>
        <div id="topDuSite">
            <top>
                <div class="dropdown">
                <span>
                    <pb id="black">_______</pb>
                    <a href="javascript:void(0)" onclick="location.href='index.html?pages/fake_index.html'">
                        <pb>Menu principal</pb>
                    </a>
                <pb id="black">______</pb>
                </span>
                <div class="dropdown-content" id="drop1">
                    <button onClick="location.href='index.html?pages/fake_index.html'"><pr>Page principale</pr></button><br>
                    <button onClick="location.href='index.html?pages/Contributeur.html'"><pr>Contributeurs</pr></button><br>
                    <button onClick="location.href='index.html?pages/FAQ.html'"><pr>Foire aux questions</pr></button><br>
                    <button onClick="location.href='index.html?pages/mention_legale.html'"><pr>Mentions légales</pr></button><br>
                </div>
                </div>
            </top>
            <top>
                <div class="dropdown">
                    <pb id="black">____________</pb>
                    <a href="javascript:void(0)" onclick="location.href='index.html?wiki/index.html';">
                        <pb>Wiki</pb>
                    </a>
                    <pb id="black">____________</pb>
                    <div class="dropdown-content" id="drop2">

                        <button onClick="location.href='index.html?wiki/index.html';"><pr>Page principale</pr></button><br>
                        <button onClick="location.href='index.html?wiki/index.html#MAIN';"><pr>Personnages disponibles</pr></button><br>
                        <button onClick="location.href='index.html?wiki/index.html';"><pr>Les Objets disponibles</pr></button><br>
                        <button onClick="location.href='index.html?wiki/index.html#ZONE';"><pr>Les Endroits</pr></button><br>
                    </div>
                </div>
            </top>
        </div>
        </center>
        <br>
        <br><br><br>

        <iframe src="" style="
            position:fixed; 
            top:0;
            left:0; 
            bottom:0; 
            right:0;
            width:100%;
            height:100%;
            border:none;
            margin:0;
            padding:0;
            overflow:hidden;
            z-index:1;"
            id="iframe_modifiable">
        </iframe>
    </body>
</html>